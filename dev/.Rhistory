group_by(state,vote_pres) %>%
count(vote_pres) %>%
group_by(state) %>%
mutate(prop=n/sum(n)) %>%
filter(vote_pres=='Hillary Clinton' | vote_pres=='Donald Trump') %>%
arrange(vote_pres, desc(prop))
ordered_state <- unique(anes_vote_state$state)
df = anes_vote_state %>%
mutate(state2=factor(state, levels=ordered_state))
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=20))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
annotate("text",x=10,y=0.8,label='CT')+
coord_flip()
anes_vote_state <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
group_by(state,vote_pres) %>%
count(vote_pres) %>%
group_by(state) %>%
mutate(prop=n/sum(n)) %>%
filter(vote_pres=='Hillary Clinton' | vote_pres=='Donald Trump') %>%
arrange(vote_pres, desc(prop))
ordered_state <- unique(anes_vote_state$state)
df = anes_vote_state %>%
mutate(state2=factor(state, levels=ordered_state))
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=20))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
annotate("text",x=20,y=0.8,label='CT')+
coord_flip()
anes_vote_state <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
group_by(state,vote_pres) %>%
count(vote_pres) %>%
group_by(state) %>%
mutate(prop=n/sum(n)) %>%
filter(vote_pres=='Hillary Clinton' | vote_pres=='Donald Trump') %>%
arrange(vote_pres, desc(prop))
ordered_state <- unique(anes_vote_state$state)
df = anes_vote_state %>%
mutate(state2=factor(state, levels=ordered_state))
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=20))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
annotate("text",x=20,y=0.55,label='PA',size=20)+
coord_flip()
anes_vote_state <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
group_by(state,vote_pres) %>%
count(vote_pres) %>%
group_by(state) %>%
mutate(prop=n/sum(n)) %>%
filter(vote_pres=='Hillary Clinton' | vote_pres=='Donald Trump') %>%
arrange(vote_pres, desc(prop))
ordered_state <- unique(anes_vote_state$state)
df = anes_vote_state %>%
mutate(state2=factor(state, levels=ordered_state))
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=20))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
annotate("text",x=20,y=0.55,label='PA',size=10)+
coord_flip()
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=20))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
annotate("text",x=20,y=0.55,label='PA',size=10)+
annotate("text",x=20,y=0.55,label='WI',size=10)+
coord_flip()
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=20))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
annotate("text",x=20,y=0.55,label='PA',size=10)+
annotate("text",x=16,y=0.55,label='WI',size=10)+
coord_flip()
anes_vote_state <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
group_by(state,vote_pres) %>%
count(vote_pres) %>%
group_by(state) %>%
mutate(prop=n/sum(n)) %>%
filter(vote_pres=='Hillary Clinton' | vote_pres=='Donald Trump') %>%
arrange(vote_pres, desc(prop))
ordered_state <- unique(anes_vote_state$state)
df = anes_vote_state %>%
mutate(state2=factor(state, levels=ordered_state))
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=20))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
annotate("text",x=20,y=0.52,label='PA',size=10)+
annotate("text",x=16,y=0.6,label='WI',size=10)+
coord_flip()
anes_vote_state <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
group_by(state,vote_pres) %>%
count(vote_pres) %>%
group_by(state) %>%
mutate(prop=n/sum(n)) %>%
filter(vote_pres=='Hillary Clinton' | vote_pres=='Donald Trump') %>%
arrange(vote_pres, desc(prop))
ordered_state <- unique(anes_vote_state$state)
df = anes_vote_state %>%
mutate(state2=factor(state, levels=ordered_state))
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=20))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
annotate("text",x=20,y=0.54,label='PA',size=10)+
annotate("text",x=16,y=0.56,label='WI',size=10)+
coord_flip()
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=20))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
annotate("text",x=20,y=0.53,label='PA',size=10)+
annotate("text",x=16,y=0.56,label='WI',size=10)+
coord_flip()
anes_vote_state <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
group_by(state,vote_pres) %>%
count(vote_pres) %>%
group_by(state) %>%
mutate(prop=n/sum(n)) %>%
filter(vote_pres=='Hillary Clinton' | vote_pres=='Donald Trump') %>%
arrange(vote_pres, desc(prop))
ordered_state <- unique(anes_vote_state$state)
df = anes_vote_state %>%
mutate(state2=factor(state, levels=ordered_state))
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=20))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
annotate("text",x=20,y=0.53,label='PA',size=10)+
annotate("text",x=16,y=0.56,label='WI',size=10)+
annotate("text",x=23,y=0.56,label='CT',size=10)+
coord_flip()
anes_vote_state <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
group_by(state,vote_pres) %>%
count(vote_pres) %>%
group_by(state) %>%
mutate(prop=n/sum(n)) %>%
filter(vote_pres=='Hillary Clinton' | vote_pres=='Donald Trump') %>%
arrange(vote_pres, desc(prop))
ordered_state <- unique(anes_vote_state$state)
df = anes_vote_state %>%
mutate(state2=factor(state, levels=ordered_state))
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=20))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
annotate("text",x=20,y=0.53,label='PA',size=10)+
annotate("text",x=16,y=0.56,label='WI',size=10)+
annotate("text",x=23,y=0.5,label='CT',size=10)+
coord_flip()
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=20))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
annotate("text",x=20,y=0.53,label='PA',size=10)+
annotate("text",x=16,y=0.56,label='WI',size=10)+
annotate("text",x=23,y=0.51,label='CT',size=10)+
coord_flip()
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=20))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
annotate("text",x=20,y=0.53,label='PA',size=10)+
annotate("text",x=16,y=0.56,label='WI',size=10)+
annotate("text",x=23,y=0.505,label='CT',size=10)+
coord_flip()
install.packages("maps")
library(maps)
map("state", fill = TRUE, col = rainbow(209),
mar = c(0, 0, 2, 0))
View(df)
library(tidyverse)
library(haven)
library(devtools)
library(RColorBrewer)
library(data.table)
library(ggplot2)
library(maps)
load(file="../output/use_dat.RData")
anes_vote_state <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
group_by(state,vote_pres) %>%
count(vote_pres) %>%
group_by(state) %>%
mutate(prop=n/sum(n)) %>%
filter(vote_pres=='Hillary Clinton' | vote_pres=='Donald Trump') %>%
arrange(vote_pres, desc(prop))
ordered_state <- unique(anes_vote_state$state)
df = anes_vote_state %>%
mutate(state2=factor(state, levels=ordered_state))
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=20))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
annotate("text",x=20,y=0.53,label='PA',size=5)+
annotate("text",x=16,y=0.56,label='WI',size=5)+
annotate("text",x=23,y=0.505,label='CT',size=5)+
coord_flip()
View(df)
data(ozone)
View(ozone)
map("state", xlim = range(ozone$x), ylim = range(ozone$y))
data(ozone)
map("state", xlim = range(ozone$x), ylim = range(ozone$y))
map("state", fill = TRUE, col = rainbow(209),
mar = c(0, 0, 2, 0))
library(maps)
data(ozone)
map("state", xlim = range(ozone$x), ylim = range(ozone$y))
map("state", fill = TRUE, col = rainbow(209),
mar = c(0, 0, 2, 0))
map("state")
View(anes_vore)
View(anes_vote)
## seems that Hillary had more supporters than Trump according to the time series data
anes_vote <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
select(vote_pres)
ggplot(anes_vote,
aes(x=vote_pres))+
geom_bar(stat="count",colour="black")+
theme_bw()+
scale_fill_brewer(palette="Blues")+
labs(title="Who did American vote in 2016")+
xlab("President voted")+
theme(plot.title = element_text(hjust = 0.5,size=15,face="bold"))
View(anes_vore)
View(anes_vote)
anes_vote %>% group_by(vote_pres) %>% count()
anes_vote %>% group_by(vote_pres) %>% count() %>% group_by(vote_pres) %>% mutate(prop=n/sum(n))
anes_vote %>% group_by(vote_pres) %>% count() %>%  mutate(prop=n/sum(n))
library(tidyverse)
library(haven)
library(devtools)
library(RColorBrewer)
library(data.table)
library(ggplot2)
load(file="../output/use_dat.RData")
View(use_dat)
anes_vote_obama_feeling <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
filter(feeling_obama>=0) %>%
group_by(vote_pres) %>%
mutate(feeling_obama = round(as.numeric(feeling_obama),0))
ggplot(anes_vote_obama_feeling,
aes(x=vote_pres, y=feeling_obama, fill=vote_pres))+
geom_boxplot()+
guides(fill=FALSE)+
stat_summary(fun.y=mean, geom="point", shape=5, size=2)+
theme(axis.text.x = element_text(angle = 20))+
labs(title="How did voters feel about Obama")+
xlab("President voted")+
ylab("Feeling for Obama")+
theme(plot.title = element_text(hjust = 0.5,size=15,face="bold"))
levels(use_dat$eco_since08)
levels(use_dat$eco_since08)[1] <- "RF"
levels(use_dat$eco_since08)[2] <- "DK"
anes_eco_08 <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
filter(eco_since08!="RF" & eco_since08!="DK") %>%
group_by(vote_pres) %>%
mutate(prop=n/sum(n))
levels(use_dat$eco_since08)[1] <- "RF"
levels(use_dat$eco_since08)[2] <- "DK"
anes_eco_08 <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
filter(eco_since08!="RF" & eco_since08!="DK") %>%
group_by(vote_pres) %>%
count(eco_since08) %>%
mutate(prop=n/sum(n))
View(anes_eco_08)
anes_vote_obama_angry <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
filter(affect_obama_angry!="Refused" & affect_obama_angry!="DK") %>%
group_by(vote_pres, affect_obama_angry) %>%
count(affect_obama_angry) %>%
group_by(vote_pres) %>%
mutate(prop = n/sum(n))
g1 <- ggplot(anes_vote_obama_angry,
aes(x=vote_pres, y=prop, fill=affect_obama_angry)) +
geom_bar(stat="identity", colour="black")+
theme_bw()+
scale_fill_brewer(palette="Blues")+
theme(axis.text.x = element_text(angle = 20))+
labs(title="Did voters feel angry about Obama?")+
xlab("President voted")+
theme(plot.title = element_text(hjust = 0.5,size=12,face="bold"))
levels(use_dat$affect_obama_proud)[c(1,2)] <- c("Refused", "DK")
anes_vote_obama_proud <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
filter(affect_obama_proud!="Refused" & affect_obama_proud!="DK") %>%
group_by(vote_pres, affect_obama_proud) %>%
count(affect_obama_proud) %>%
group_by(vote_pres) %>%
mutate(prop = n/sum(n))
g2 <- ggplot(anes_vote_obama_proud,
aes(x=vote_pres, y=prop, fill=affect_obama_proud)) +
geom_bar(stat="identity", colour="black")+
theme_bw()+
scale_fill_brewer(palette="Blues")+
theme(axis.text.x = element_text(angle = 20))+
labs(title="Did voters feel proud of Obama?")+
xlab("President voted")+
theme(plot.title = element_text(hjust = 0.5,size=12,face="bold"))
library(cowplot)
plot_grid(g1, g2, labels = "AUTO")
ggplot(anes_eco_08,
aes(x=vote_pres, y=prop, fill=eco_since08)) +
geom_bar(stat="identity", colour="black")+
theme_bw()+
scale_fill_brewer(palette="Blues")+
theme(axis.text.x = element_text(angle = 20))+
labs(title="xx")+
xlab("President voted")+
theme(plot.title = element_text(hjust = 0.5,size=12,face="bold"))
anes_vote_gay <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
group_by(vote_pres, gay_marriage, mode) %>%
count(gay_marriage) %>%
group_by(vote_pres, mode) %>%
mutate(prop=n/sum(n))
#options(repr.plot.width = 28, repr.plot.height = 14)
ggplot(anes_vote_gay,
aes(x=vote_pres, y=prop, fill=gay_marriage))+
geom_bar(stat="identity", colour="black")+
facet_wrap(~mode, ncol=1)+
labs(title="How did voters view gay marriage")+
xlab("President voted")+
theme(plot.title = element_text(hjust = 0.5,size=15,face="bold"))+
coord_fixed(ratio=2)
anes_vote_gay <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
group_by(vote_pres, gay_marriage, mode) %>%
count(gay_marriage) %>%
group_by(vote_pres) %>%
mutate(prop=n/sum(n))
ggplot(anes_vote_gay,
aes(x=vote_pres, y=prop, fill=gay_marriage))+
geom_bar(stat="identity", colour="black")+
labs(title="How did voters view gay marriage")+
xlab("President voted")+
theme(plot.title = element_text(hjust = 0.5,size=15,face="bold"))+
coord_fixed(ratio=2)
anes_vote_gay <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
group_by(vote_pres, gay_marriage) %>%
count(gay_marriage) %>%
group_by(vote_pres) %>%
mutate(prop=n/sum(n))
ggplot(anes_vote_gay,
aes(x=vote_pres, y=prop, fill=gay_marriage))+
geom_bar(stat="identity", colour="black")+
labs(title="How did voters view gay marriage")+
xlab("President voted")+
theme(plot.title = element_text(hjust = 0.5,size=15,face="bold"))+
coord_fixed(ratio=2)
###### This R file is used to extract relevent variables #####
###### from ANES Time Series 2016 for analysis           #####
library(tidyverse)
library(haven)
anes_dat_2016 <- read_sav("../data/anes_timeseries_2016.sav")
use_dat <- anes_dat_2016 %>%
transmute(mode = as_factor(V160501),
pre_post = as_factor(V160502),
state = as_factor(V161010d),
feeling_dem_can = V161086,
feeling_rep_can = V161087,
feeling_obama = V161092,
feeling_clinton = V161093,
feeling_dem_party = V161095,
feeling_rep_party = V161096,
affect_dem_can_angry = as_factor(V161116),
affect_dem_can_hopeful = as_factor(V161117),
affect_dem_can_afraid = as_factor(V161118),
affect_dem_can_proud = as_factor(V161119),
affect_dem_can_disgusted = as_factor(V161120),
affect_rep_can_angry = as_factor(V161121),
affect_rep_can_hopeful = as_factor(V161122),
affect_rep_can_afraid = as_factor(V161123),
affect_rep_can_proud = as_factor(V161124),
affect_rep_can_disgusted = as_factor(V161125),
affect_obama_angry = as_factor(V161236),
affect_obama_proud = as_factor(V161237),
race = as_factor(V161310x),
gay_marriage = as_factor(V161231),
abortion = as_factor(V161232),
death_penalty = as_factor(V161233),
eco_since08 = as_factor(V161235x),
vote_pres = as_factor(V162062x),
turnout = as_factor(V162065x)
)
# factor level transformation
levels(use_dat$affect_obama_angry)[c(1,2)] <- c("Refused", "DK")
levels(use_dat$vote_pres) <- c("Refused","DK","Missing","INAP","Hillary Clinton",
"Donald Trump","Gary Johnson","Jill Stein","Other")
levels(use_dat$race)=c("Missing","Missing","White","Black","Asian, native Hawaiian or other Pacif Islr","Native American or Alaska Native","Hispanic","Other non-Hispanic")
levels(use_dat$abortion)[c(1,2)] <- c("Refused","DK")
levels(use_dat$eco_since08)[1] <- "RF"
levels(use_dat$eco_since08)[2] <- "DK"
save(use_dat, file="../output/use_dat.RData")
load(file="../output/use_dat.RData")
anes_eco_08 <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
filter(eco_since08!="RF" & eco_since08!="DK") %>%
group_by(vote_pres) %>%
count(eco_since08) %>%
mutate(prop=n/sum(n))
ggplot(anes_eco_08,
aes(x=vote_pres, y=prop, fill=eco_since08)) +
geom_bar(stat="identity", colour="black")+
theme_bw()+
scale_fill_brewer(palette="Blues")+
theme(axis.text.x = element_text(angle = 20))+
labs(title="How did voters think about the economy after 2008?")+
xlab("President voted")+
theme(plot.title = element_text(hjust = 0.5,size=12,face="bold"))
anes_eco_08 <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
filter(eco_since08!="RF" & eco_since08!="DK") %>%
group_by(vote_pres) %>%
count(eco_since08) %>%
mutate(prop=n/sum(n))
ggplot(anes_eco_08,
aes(x=vote_pres, y=prop, fill=eco_since08)) +
geom_bar(stat="identity", colour="black")+
theme_bw()+
scale_fill_brewer(palette="Blues")+
theme(axis.text.x = element_text(angle = 0))+
labs(title="How did voters think about the economy after 2008?")+
xlab("President voted")+
theme(plot.title = element_text(hjust = 0.5,size=12,face="bold"))
