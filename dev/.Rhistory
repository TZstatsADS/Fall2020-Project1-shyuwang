df = anes_vote_state %>%
mutate(state2=factor(state, levels=ordered_state))
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=15))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
coord_flip()
# 根据问卷数据，希拉里在威斯康星、宾夕法尼亚都有超过50%的支持率，但最后没有得到该州的选举人票；康涅狄格州的支持率不足50%，但最后得到了该州的选举人票
anes_vote_state <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
group_by(state,vote_pres) %>%
count(vote_pres) %>%
group_by(state) %>%
mutate(prop=n/sum(n)) %>%
filter(vote_pres=='Hillary Clinton' | vote_pres=='Donald Trump') %>%
arrange(vote_pres, desc(prop))
ordered_state <- unique(anes_vote_state$state)
df = anes_vote_state %>%
mutate(state2=factor(state, levels=ordered_state))
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=20))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
coord_flip()
View(anes_vote_state)
anes_vote_state2 <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
group_by(state) %>%
count(vote_pres) %>%
group_by(state)
View(anes_vote_state2)
anes_vote_state2 <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
group_by(state) %>%
count()
View(anes_vote_state2)
anes_vote_state2 <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
group_by(state) %>%
count() %>%
arrange(n)
View(anes_vote_state2)
anes_vote_state2 <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
group_by(state) %>%
count() %>%
arrange(n)
head(anes_vote_state2)
anes_vote_gay <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
group_by(vote_pres, gay_marriage, mode) %>%
count(gay_marriage) %>%
group_by(vote_pres, mode) %>%
mutate(prop=n/sum(n))
#options(repr.plot.width = 28, repr.plot.height = 14)
ggplot(anes_vote_gay,
aes(x=vote_pres, y=prop, fill=gay_marriage))+
geom_bar(stat="identity", colour="black")+
facet_wrap(~mode, ncol=1)+
labs(title="How did voters view gay marriage")+
xlab("President voted")+
theme(plot.title = element_text(hjust = 0.5,size=15,face="bold"))+
coord_fixed(ratio=2)
anes_vote_gay <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
group_by(vote_pres, gay_marriage, mode) %>%
count(gay_marriage) %>%
group_by(vote_pres, mode) %>%
mutate(prop=n/sum(n))
#options(repr.plot.width = 28, repr.plot.height = 14)
ggplot(anes_vote_gay,
aes(x=vote_pres, y=prop, fill=gay_marriage))+
geom_bar(stat="identity", colour="black")+
facet_wrap(~mode, ncol=1)+
labs(title="How did voters view gay marriage")+
xlab("President voted")+
theme(plot.title = element_text(hjust = 0.5,size=15,face="bold"))+
coord_fixed(ratio=2)
anes_vote_gay <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
group_by(vote_pres, gay_marriage, mode) %>%
count(gay_marriage) %>%
group_by(vote_pres, mode) %>%
mutate(prop=n/sum(n))
#options(repr.plot.width = 28, repr.plot.height = 14)
ggplot(anes_vote_gay,
aes(x=vote_pres, y=prop, fill=gay_marriage))+
geom_bar(stat="identity", colour="black")+
facet_wrap(~mode, ncol=1)+
labs(title="How did voters view gay marriage")+
xlab("President voted")+
theme(plot.title = element_text(hjust = 0.5,size=15,face="bold"))+
coord_fixed(ratio=2)
anes_vote_state <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
group_by(state,vote_pres) %>%
count(vote_pres) %>%
group_by(state) %>%
mutate(prop=n/sum(n)) %>%
filter(vote_pres=='Hillary Clinton' | vote_pres=='Donald Trump') %>%
arrange(vote_pres, desc(prop))
ordered_state <- unique(anes_vote_state$state)
df = anes_vote_state %>%
mutate(state2=factor(state, levels=ordered_state))
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=20))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
annotate("text")+
coord_flip()
anes_vote_state <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
group_by(state,vote_pres) %>%
count(vote_pres) %>%
group_by(state) %>%
mutate(prop=n/sum(n)) %>%
filter(vote_pres=='Hillary Clinton' | vote_pres=='Donald Trump') %>%
arrange(vote_pres, desc(prop))
ordered_state <- unique(anes_vote_state$state)
df = anes_vote_state %>%
mutate(state2=factor(state, levels=ordered_state))
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=20))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
#annotate("text",x=)+
coord_flip()
anes_vote_state <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
group_by(state,vote_pres) %>%
count(vote_pres) %>%
group_by(state) %>%
mutate(prop=n/sum(n)) %>%
filter(vote_pres=='Hillary Clinton' | vote_pres=='Donald Trump') %>%
arrange(vote_pres, desc(prop))
ordered_state <- unique(anes_vote_state$state)
df = anes_vote_state %>%
mutate(state2=factor(state, levels=ordered_state))
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=20))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
geom_text(aes(x=state2,y=0.8,label=state2))+
coord_flip()
anes_vote_state <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
group_by(state,vote_pres) %>%
count(vote_pres) %>%
group_by(state) %>%
mutate(prop=n/sum(n)) %>%
filter(vote_pres=='Hillary Clinton' | vote_pres=='Donald Trump') %>%
arrange(vote_pres, desc(prop))
ordered_state <- unique(anes_vote_state$state)
df = anes_vote_state %>%
mutate(state2=factor(state, levels=ordered_state))
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=20))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
annotate("text",x=10,y=0.8)+
coord_flip()
anes_vote_state <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
group_by(state,vote_pres) %>%
count(vote_pres) %>%
group_by(state) %>%
mutate(prop=n/sum(n)) %>%
filter(vote_pres=='Hillary Clinton' | vote_pres=='Donald Trump') %>%
arrange(vote_pres, desc(prop))
ordered_state <- unique(anes_vote_state$state)
df = anes_vote_state %>%
mutate(state2=factor(state, levels=ordered_state))
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=20))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
annotate("text",x=10,y=0.8,label=state2)+
coord_flip()
anes_vote_state <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
group_by(state,vote_pres) %>%
count(vote_pres) %>%
group_by(state) %>%
mutate(prop=n/sum(n)) %>%
filter(vote_pres=='Hillary Clinton' | vote_pres=='Donald Trump') %>%
arrange(vote_pres, desc(prop))
ordered_state <- unique(anes_vote_state$state)
df = anes_vote_state %>%
mutate(state2=factor(state, levels=ordered_state))
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=20))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
annotate("text",x=10,y=0.8,label='CT')+
coord_flip()
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=20))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
annotate("text",x=5,y=0.8,label='CT')+
coord_flip()
anes_vote_state <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
group_by(state,vote_pres) %>%
count(vote_pres) %>%
group_by(state) %>%
mutate(prop=n/sum(n)) %>%
filter(vote_pres=='Hillary Clinton' | vote_pres=='Donald Trump') %>%
arrange(vote_pres, desc(prop))
ordered_state <- unique(anes_vote_state$state)
df = anes_vote_state %>%
mutate(state2=factor(state, levels=ordered_state))
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=20))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
annotate("text",x=1,y=0.8,label='CT')+
coord_flip()
anes_vote_state <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
group_by(state,vote_pres) %>%
count(vote_pres) %>%
group_by(state) %>%
mutate(prop=n/sum(n)) %>%
filter(vote_pres=='Hillary Clinton' | vote_pres=='Donald Trump') %>%
arrange(vote_pres, desc(prop))
ordered_state <- unique(anes_vote_state$state)
df = anes_vote_state %>%
mutate(state2=factor(state, levels=ordered_state))
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=20))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
annotate("text",x=10,y=0.8,label='CT')+
coord_flip()
anes_vote_state <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
group_by(state,vote_pres) %>%
count(vote_pres) %>%
group_by(state) %>%
mutate(prop=n/sum(n)) %>%
filter(vote_pres=='Hillary Clinton' | vote_pres=='Donald Trump') %>%
arrange(vote_pres, desc(prop))
ordered_state <- unique(anes_vote_state$state)
df = anes_vote_state %>%
mutate(state2=factor(state, levels=ordered_state))
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=20))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
annotate("text",x=20,y=0.8,label='CT')+
coord_flip()
anes_vote_state <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
group_by(state,vote_pres) %>%
count(vote_pres) %>%
group_by(state) %>%
mutate(prop=n/sum(n)) %>%
filter(vote_pres=='Hillary Clinton' | vote_pres=='Donald Trump') %>%
arrange(vote_pres, desc(prop))
ordered_state <- unique(anes_vote_state$state)
df = anes_vote_state %>%
mutate(state2=factor(state, levels=ordered_state))
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=20))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
annotate("text",x=20,y=0.55,label='PA',size=20)+
coord_flip()
anes_vote_state <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
group_by(state,vote_pres) %>%
count(vote_pres) %>%
group_by(state) %>%
mutate(prop=n/sum(n)) %>%
filter(vote_pres=='Hillary Clinton' | vote_pres=='Donald Trump') %>%
arrange(vote_pres, desc(prop))
ordered_state <- unique(anes_vote_state$state)
df = anes_vote_state %>%
mutate(state2=factor(state, levels=ordered_state))
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=20))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
annotate("text",x=20,y=0.55,label='PA',size=10)+
coord_flip()
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=20))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
annotate("text",x=20,y=0.55,label='PA',size=10)+
annotate("text",x=20,y=0.55,label='WI',size=10)+
coord_flip()
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=20))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
annotate("text",x=20,y=0.55,label='PA',size=10)+
annotate("text",x=16,y=0.55,label='WI',size=10)+
coord_flip()
anes_vote_state <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
group_by(state,vote_pres) %>%
count(vote_pres) %>%
group_by(state) %>%
mutate(prop=n/sum(n)) %>%
filter(vote_pres=='Hillary Clinton' | vote_pres=='Donald Trump') %>%
arrange(vote_pres, desc(prop))
ordered_state <- unique(anes_vote_state$state)
df = anes_vote_state %>%
mutate(state2=factor(state, levels=ordered_state))
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=20))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
annotate("text",x=20,y=0.52,label='PA',size=10)+
annotate("text",x=16,y=0.6,label='WI',size=10)+
coord_flip()
anes_vote_state <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
group_by(state,vote_pres) %>%
count(vote_pres) %>%
group_by(state) %>%
mutate(prop=n/sum(n)) %>%
filter(vote_pres=='Hillary Clinton' | vote_pres=='Donald Trump') %>%
arrange(vote_pres, desc(prop))
ordered_state <- unique(anes_vote_state$state)
df = anes_vote_state %>%
mutate(state2=factor(state, levels=ordered_state))
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=20))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
annotate("text",x=20,y=0.54,label='PA',size=10)+
annotate("text",x=16,y=0.56,label='WI',size=10)+
coord_flip()
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=20))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
annotate("text",x=20,y=0.53,label='PA',size=10)+
annotate("text",x=16,y=0.56,label='WI',size=10)+
coord_flip()
anes_vote_state <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
group_by(state,vote_pres) %>%
count(vote_pres) %>%
group_by(state) %>%
mutate(prop=n/sum(n)) %>%
filter(vote_pres=='Hillary Clinton' | vote_pres=='Donald Trump') %>%
arrange(vote_pres, desc(prop))
ordered_state <- unique(anes_vote_state$state)
df = anes_vote_state %>%
mutate(state2=factor(state, levels=ordered_state))
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=20))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
annotate("text",x=20,y=0.53,label='PA',size=10)+
annotate("text",x=16,y=0.56,label='WI',size=10)+
annotate("text",x=23,y=0.56,label='CT',size=10)+
coord_flip()
anes_vote_state <- use_dat %>%
filter(vote_pres!="Refused"&vote_pres!="DK"&vote_pres!="INAP"&vote_pres!="Missing") %>%
group_by(state,vote_pres) %>%
count(vote_pres) %>%
group_by(state) %>%
mutate(prop=n/sum(n)) %>%
filter(vote_pres=='Hillary Clinton' | vote_pres=='Donald Trump') %>%
arrange(vote_pres, desc(prop))
ordered_state <- unique(anes_vote_state$state)
df = anes_vote_state %>%
mutate(state2=factor(state, levels=ordered_state))
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=20))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
annotate("text",x=20,y=0.53,label='PA',size=10)+
annotate("text",x=16,y=0.56,label='WI',size=10)+
annotate("text",x=23,y=0.5,label='CT',size=10)+
coord_flip()
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=20))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
annotate("text",x=20,y=0.53,label='PA',size=10)+
annotate("text",x=16,y=0.56,label='WI',size=10)+
annotate("text",x=23,y=0.51,label='CT',size=10)+
coord_flip()
ggplot(df,
aes(x=state2, y=prop))+
geom_bar(stat="identity", colour="white", aes(fill=vote_pres), position="dodge", width=0.8)+
guides(fill = guide_legend(reverse = TRUE)) +
xlab("State")+
theme(axis.title.x = element_text(size=20))+
scale_fill_manual(values = c("#00188F","#00BCF2"),
labels = c("Hillary Clinton","Donald Trump"))+
geom_hline(aes(yintercept=0.5), color="purple", linetype="dashed")+
annotate("text",x=20,y=0.53,label='PA',size=10)+
annotate("text",x=16,y=0.56,label='WI',size=10)+
annotate("text",x=23,y=0.505,label='CT',size=10)+
coord_flip()
